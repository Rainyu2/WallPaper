{"version":3,"file":"classlist.js","sources":["pages/classlist/classlist.vue","../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY2xhc3NsaXN0L2NsYXNzbGlzdC52dWU"],"sourcesContent":["<template>\r\n\t<!-- 通过对数组长度的访问和noData的布尔值来控制顶部加载组件 -->\n\t<view class=\"classList\">\r\n\t\t<view class=\"loadingLayout\" v-if=\"!classList.length && !noData\">\r\n\t\t\t<uni-load-more status=\"loading\"></uni-load-more>\r\n\t\t</view>\r\n\t\t\n\t\t<view class=\"content\">\r\n\t\t\t<navigator :url=\"'/pages/preview/preview?id='+item._id\" class=\"item\" \r\n\t\t\tv-for=\"item in classList\"\r\n\t\t\t:key=\"item._id\">\r\n\t\t\t\t<image :src=\"item.smallPicurl\" mode=\"aspectFill\"></image>\r\n\t\t\t</navigator>\r\n\t\t</view>\r\n\t\t<!-- 通过对数组长度的访问和noData的布尔值来控制底部下拉刷新组件 -->\r\n\t\t<view class=\"loadingLayout\" v-if=\"classList.length || noData\">\r\n\t\t\t<uni-load-more :status=\"noData?'noMore':'loading'\"></uni-load-more>\r\n\t\t</view>\r\n\t\t<!-- 用于小程序端控制底部安全区域 -->\r\n\t\t<view class=\"safe-area-inset-bottom\"></view>\n\t</view>\n</template>\n\n<script setup>\nimport { ref } from 'vue';\r\nimport  {apiGetClassList,apiGetHistoryList} from '@/api/api.js';\r\nimport {gotoHome} from '@/utils/common.js'\nimport {onLoad,onReachBottom,onShareAppMessage,onShareTimeline,onUnload} from '@dcloudio/uni-app';\r\n\r\n//分类列表数据\nconst classList =ref([]);\r\n\r\nconst noData = ref(false)\r\n//定义data参数\r\nconst queryParams = {\r\n\tpageNum:1,\r\n\tpageSize:12\r\n}\r\nlet pageName;\r\n//在setup语法糖中onLoad的执行顺序晚于自己定义的网络请求函数，所以需要将网络请求函数放在onLoad里\r\nonLoad((e)=>{\r\n\tconsole.log(e);\r\n\tlet {id=null,name=null,type=null} = e;\r\n\tif(type) queryParams.type = type\r\n\tif(id) queryParams.classid = id\r\n\t// if(!id) gotoHome();\r\n\tpageName = name\r\n\tuni.setNavigationBarTitle({\r\n\t\ttitle:name\r\n\t})\r\n\tgetClassList();\r\n})\r\n\r\nonReachBottom(()=>{\r\n\tif(noData.value) return;\r\n\tqueryParams.pageNum++;\r\n\tgetClassList()\r\n})\r\n\r\n//获取分类列表网格数据\r\nconst getClassList = async()=>{\r\n\t//分别选择如果是传的classid就调用获取原分类界面，如果是type类型就调用获取用户分类界面\r\n\tlet res;\r\n\tif(queryParams.classid) res = await apiGetClassList(queryParams);\r\n\tif(queryParams.type) res = await apiGetHistoryList(queryParams);\r\n\t\r\n\t//将新老数据结合以达到可以逐渐加载更多图片效果\r\n\tclassList.value =[...classList.value, ...res.data];\r\n\tif(queryParams.pageSize >res.data.length) noData.value = true\r\n\tuni.setStorageSync(\"storgClassList\",classList.value)\r\n\tconsole.log(res.data)\r\n}\r\n\r\n//分享给好友\r\nonShareAppMessage((e)=>{\r\n\treturn {\r\n\t\ttitle:\"wallpaper-\"+pageName,\r\n\t\t// 带参数实现个性化页面分享title\r\n\t\tpath:\"/pages/classlist/classlist?id=\"+queryParams.classid+\"&name=\"+pageName\r\n\t}\r\n})\r\n\r\n//分享朋友圈\r\nonShareTimeline(()=>{\r\n\treturn {\r\n\t\ttitle:\"wallpapers\"\r\n\t}\r\n})\r\n\r\nonUnload(()=>{\r\n\tuni.removeStorageSync(\"storgClassList\")\r\n})\n</script>\n\n<style lang=\"scss\" scoped>\n.classList{\r\n\t.content{\r\n\t\tdisplay: grid;\r\n\t\tgrid-template-columns: repeat(3,1fr);\r\n\t\tgap: 5rpx;\r\n\t\tpadding: 5rpx;\r\n\t\t.item{\r\n\t\t\theight: 440rpx;\r\n\t\t\timage{\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\theight: 100%;\r\n\t\t\t\tdisplay: block;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\n</style>\n","import MiniProgramPage from 'E:/HbuilderProjects/wallpaper-kt/pages/classlist/classlist.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onLoad","uni","onReachBottom","apiGetClassList","apiGetHistoryList","onShareAppMessage","onShareTimeline","onUnload"],"mappings":";;;;;;;;;;;;;;AA8BA,UAAA,YAAAA,cAAAA,IAAA,CAAA,CAAA;AAEA,UAAA,SAAAA,cAAA,IAAA,KAAA;AAEA,UAAA,cAAA;AAAA,MACA,SAAA;AAAA,MACA,UAAA;AAAA,IACA;AACA,QAAA;AAEAC,kBAAA,OAAA,CAAA,MAAA;AACAC,oBAAAA,MAAA,MAAA,OAAA,uCAAA,CAAA;AACA,UAAA,EAAA,KAAA,MAAA,OAAA,MAAA,OAAA,KAAA,IAAA;AACA,UAAA;AAAA,oBAAA,OAAA;AACA,UAAA;AAAA,oBAAA,UAAA;AAEA,iBAAA;AACAA,oBAAAA,MAAA,sBAAA;AAAA,QACA,OAAA;AAAA,MACA,CAAA;AACA;IACA,CAAA;AAEAC,kBAAAA,cAAA,MAAA;AACA,UAAA,OAAA;AAAA;AACA,kBAAA;AACA,mBAAA;AAAA,IACA,CAAA;AAGA,UAAA,eAAA,YAAA;AAEA,UAAA;AACA,UAAA,YAAA;AAAA,cAAA,MAAAC,QAAA,gBAAA,WAAA;AACA,UAAA,YAAA;AAAA,cAAA,MAAAC,QAAA,kBAAA,WAAA;AAGA,gBAAA,QAAA,CAAA,GAAA,UAAA,OAAA,GAAA,IAAA,IAAA;AACA,UAAA,YAAA,WAAA,IAAA,KAAA;AAAA,eAAA,QAAA;AACAH,oBAAAA,MAAA,eAAA,kBAAA,UAAA,KAAA;AACAA,oBAAAA,MAAA,MAAA,OAAA,uCAAA,IAAA,IAAA;AAAA,IACA;AAGAI,kBAAA,kBAAA,CAAA,MAAA;AACA,aAAA;AAAA,QACA,OAAA,eAAA;AAAA;AAAA,QAEA,MAAA,mCAAA,YAAA,UAAA,WAAA;AAAA,MACA;AAAA,IACA,CAAA;AAGAC,kBAAAA,gBAAA,MAAA;AACA,aAAA;AAAA,QACA,OAAA;AAAA,MACA;AAAA,IACA,CAAA;AAEAC,kBAAAA,SAAA,MAAA;AACAN,oBAAA,MAAA,kBAAA,gBAAA;AAAA,IACA,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1FA,GAAG,WAAW,eAAe;"}